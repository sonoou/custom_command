#!/bin/bash

APP_LIST=$(cat $1)
LOOP=$(echo "$APP_LIST" | wc -l)
INSTALLED_APP_LIST=$(adb shell pm -l)
#echo "$INSTALLED_APP_LIST"
for (( i=1; i<=$LOOP; i++ )) do
	APP_DETAILS=$(echo "$APP_LIST" | head "-$i" | tail -1)
	APP_PACKAGE=$(echo $APP_DETAILS | awk '{print $1}')
	APP_NAME=$(echo $APP_DETAILS | awk '{print $2}')
#	echo $APP_NAME
if [ -n "$(echo "$INSTALLED_APP_LIST" | grep $APP_PACKAGE)" ]; then
		echo -e "[FOUND]: \t\t$APP_NAME"
		echo -e "[DELETING]: \t\t$APP_NAME"
		OUT=$(adb shell pm uninstall -k --user 0 $APP_PACKAGE)
		if [ "$OUT" == "Success" ]; then
			echo -e "[DONE]: \t\t$APP_NAME"
		else
			echo -e "\033[0;31m[ERROR]\033[0m: \t\t$APP_NAME \t\tpackage: $APP_PACKAGE"
		fi
#	else
#		echo -e "[NOT FOUND]: \t$APP_NAME"
	fi
done
